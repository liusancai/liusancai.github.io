<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>迈普交换机基础操作 - 自由的网工</title>









<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-1-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="迈普交换机基础操作" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-end">
                
                
                
            </div>
        </div>
    </div>
</nav>
    

    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-12 has-order-2 column-main">

<div class="card">
    
	
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
					
                <time class="level-item has-text-grey" datetime="2020-02-03T04:15:08.000Z">2020-02-03</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/">网络技术</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/">网络基础</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    11 分钟 读完 (大约 1576 个字)
                </span>
                
				
					<span class="level-item has-text-grey">
					<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
					</script>
					<class="article-titles"> 浏览：<span id="busuanzi_value_page_pv"></span>
					</span>
								
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                迈普交换机基础操作
            
        </h1>
        <div class="content">
			<hr style="height:1px;border:none;border-top:1px dashed #0066CC;" />
            <h1 id="一、配置本地用户认证"><a href="#一、配置本地用户认证" class="headerlink" title="一、配置本地用户认证"></a>一、配置本地用户认证</h1><p>全局配置模式下<br>configure terminal<br>创建用户，配置用户名为test用户，密码为test，权限为15级<br>username test privilege 15 password 0 test<br>打开本地认证方式<br>authentication line vty login local<br>配置特权密码testpassword<br>enable password level 15 testpassword<br>配置示例：</p>
<a id="more"></a>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Switch&gt;enable    </span><br><span class="line">Switch#configure terminal     </span><br><span class="line">Switch(config)#username test privilege 15 password 0 test    </span><br><span class="line">Switch(config)#authentication line vty login local    </span><br><span class="line">Switch(config)#enable password level 15 testpassword</span><br></pre></td></tr></table></figure>
<h1 id="二、配置VLAN"><a href="#二、配置VLAN" class="headerlink" title="二、配置VLAN"></a>二、配置VLAN</h1><p>全局配置模式下，创建vlan 10<br>Vlan 10<br>添加描述信息<br>name Bangong<br>配置示例：<br>Switch(config)#vlan 10<br>Switch(config-vlan10)#name bangong<br>三、端口加入VLAN<br>配置access类型端口<br>全局模式下进入端口配置模式<br>进入G0/1<br>interface gigabitethernet0/1<br>配置端口类型为access<br>switchport mode access<br>配置端口所属vlan<br>switchport access vlan 10<br>打开端口(如果端口关闭)<br>no shutdown<br>配置示例：   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Switch#configure terminal     </span><br><span class="line">Switch(config)#interface gigabitethernet 0&#x2F;1    </span><br><span class="line">Switch(config-if-gigabitethernet0&#x2F;1)#switchport mode access    </span><br><span class="line">Switch(config-if-gigabitethernet0&#x2F;1)#switchport access vlan 10    </span><br><span class="line">Switch(config-if-gigabitethernet0&#x2F;1)#no shutdown    </span><br><span class="line">Switch(config-if-gigabitethernet0&#x2F;1)#exit    </span><br><span class="line">Switch(config)#exit    </span><br><span class="line">Switch#</span><br></pre></td></tr></table></figure>
<p>配置trunk类型端口（trunk类型端口适用于交换机接交换机）<br>全局模式下进入端口配置模式<br>进入G0/48<br>interface gigabitethernet0/48<br>配置端口模式为trunk模式<br>switchport mode trunk<br>配置端口允许通过的VLAN<br>switchport trunk allowed vlan all<br>配置默认的pvid，不配置的情况下默认pvid为1<br>switchport trunk pvid vlan 1<br>配置示例： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Switch#configure terminal     </span><br><span class="line">Switch(config)#interface gigabitethernet 0&#x2F;48    </span><br><span class="line">Switch(config-if-gigabitethernet0&#x2F;48)#switchport mode trunk    </span><br><span class="line">Switch(config-if-gigabitethernet0&#x2F;48)#switchport trunk allowed vlan all    </span><br><span class="line">Switch(config-if-gigabitethernet0&#x2F;48)#switchport trunk pvid vlan 1    </span><br><span class="line">Switch(config-if-gigabitethernet0&#x2F;48)#no shutdown    </span><br><span class="line">Switch(config-if-gigabitethernet0&#x2F;48)#exit    </span><br><span class="line">Switch(config)#exit    </span><br><span class="line">Switch#</span><br></pre></td></tr></table></figure>
<h1 id="三、配置接口-VLAN-IP"><a href="#三、配置接口-VLAN-IP" class="headerlink" title="三、配置接口 VLAN IP"></a>三、配置接口 VLAN IP</h1><p>全局模式下进入vlanif接口配置模式<br>进入vlan10 三层接口<br>interface vlan 10<br>配置IP地址 192.168.1.1 掩码255.255.255.0<br>ip address 192.168.1.1 255.255.255.0<br>配置示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Switch#configure terminal     </span><br><span class="line">Switch(config)#interface vlan 10    </span><br><span class="line">Switch(config-if-vlan10)#ip address 192.168.1.1 255.255.255.0    </span><br><span class="line">Switch(config-if-vlan10)#exit    </span><br><span class="line">Switch(config)#exit    </span><br><span class="line">Switch#</span><br></pre></td></tr></table></figure>
<h1 id="四、配置静态默认路由"><a href="#四、配置静态默认路由" class="headerlink" title="四、配置静态默认路由"></a>四、配置静态默认路由</h1><p>全局配置模式下，配置默认路由的下一跳为192.168.1.2<br>ip route 0.0.0.0 0.0.0.0 192.168.1.2<br>静态路由配置和默认路由配置命令一样，命令中前0.0.0.0 代表网络号，后面一个0.0.0.0代表掩码。这8个0则能代表所有网段。代码一个24未掩码的网段表示：192.168.2.0 255.255.255.0<br>配置静态路由：<br>ip route 192.168.2.0 255.255.255.0 192.168.1.2<br>配置示例：<br>Switch(config)#ip route 0.0.0.0 0.0.0.0 192.168.1.2    </p>
<h1 id="五、配置生成树选项"><a href="#五、配置生成树选项" class="headerlink" title="五、配置生成树选项"></a>五、配置生成树选项</h1><p>生成树配置需要结合当地网络进行配置，要所有运行在一个拓扑能开启生成树功能的交换机，生成树配置一样。如果不知道在运行的生成树实例的情况下，建议暂时不配置生成树，避免生成树造成冲突。<br>全局模式下开启生成树功能<br>spanning-tree enable<br>全局模式下关闭生成树功能<br>no spanning-tree enable<br>配置生成树模式为mstp<br>spanning-tree mode mstp<br>进入多实例生成树MSTP配置<br>spanning-tree mst configuration<br>配置生成树域名test<br>region-name test<br>配置实例1包含vlan10<br>instance 1 vlan 10<br>配置实例2包含vlan20<br>instance 2 vlan 20<br>激活生成树配置<br>active configuration pending<br>不包含实例中的vlan，全部属于默认实例0，如vlan1默认属于实例0<br>配置示例： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Switch#configure terminal     </span><br><span class="line">(config)#spanning-tree enable    </span><br><span class="line">Switch(config)#spanning-tree mode mstp    </span><br><span class="line">Switch(config)#spanning-tree mst configuration     </span><br><span class="line">Switch(config-mst)#region-name test    </span><br><span class="line">Switch(config-mst)#instance 1 vlan 10    </span><br><span class="line">Switch(config-mst)#instance 2 vlan 20    </span><br><span class="line">Switch(config-mst)#active configuration pending    </span><br><span class="line">Switch(config-mst)#exit    </span><br><span class="line">Switch(config)#</span><br></pre></td></tr></table></figure>
<h1 id="六、配置ACL访问控制策略"><a href="#六、配置ACL访问控制策略" class="headerlink" title="六、配置ACL访问控制策略"></a>六、配置ACL访问控制策略</h1><p>进入acl配置模式<br>ip access-list standard 100     #数字可配置1-1000,基础ACL配置，供电网络中采用基础acl#<br>配置一条允许23.50.0.99主机<br>10 permit host 23.50.6.99<br>配置一条允许23.50.6.0网段<br>20 permit 23.50.6.0 255.255.255.0<br>剩余的全部禁止<br>30 deny any<br>配置acl注意匹配规则是从上往下匹配，比如deny any已经拒绝了除10,20匹配到的，剩余的都是禁止。这时候40 permit 23.50.7.0 0.0.0.255，则该策略不生效，23.50.7.0网段还是被全部禁止。<br>配置示例：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Switch(config)#ip access-list standard 100    </span><br><span class="line">Switch(config-std-nacl)#10 permit host 23.50.6.99    </span><br><span class="line">Switch(config-std-nacl)#20 permit 23.50.6.0 255.255.255.0    </span><br><span class="line">Switch(config-std-nacl)#30 deny any</span><br></pre></td></tr></table></figure>
<h1 id="七、配置SSH远程登陆"><a href="#七、配置SSH远程登陆" class="headerlink" title="七、配置SSH远程登陆"></a>七、配置SSH远程登陆</h1><p>全局开启ssh服务<br>ip ssh server<br>进入配置交换机的vty接口模式下，下面相当于可以同时5个人登陆这台交换机<br>user-interface vty 0 4<br>配置远程登陆的认证模式为AAA，即为本地用户认证<br>login local<br>设置超时5分钟自动断开回话<br>exec-timeout 5 0<br>配置只允许ssh方式登陆交换机<br>Protocol input ssh<br>配置示例：    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Switch(config)#line vty 0 4    </span><br><span class="line">Switch(config-line)#login local     </span><br><span class="line">Switch(config-line)#exec-timeout 5 0    </span><br><span class="line">Switch(config-line)#protocol input ssh     </span><br><span class="line">Switch(config-line)#privilege level 0    </span><br><span class="line">Switch(config-line)#exit    </span><br><span class="line">Switch(config)#    </span><br><span class="line">&#96;&#96;&#96;    </span><br><span class="line"># 八、配置时钟同步和时区    </span><br><span class="line">全局模式下配置时区为北京时区(加8小时)    </span><br><span class="line">clock timezone beijin 8    </span><br><span class="line">全局模式下配置时钟服务器10.109.192.5为第一个时钟服务器    </span><br><span class="line">ntp server 10.109.192.5    </span><br><span class="line">全局模式下配置时钟服务器10.109.192.43为备用时钟服务器    </span><br><span class="line">ntp server 10.109.192.43    </span><br><span class="line">配置示例：</span><br></pre></td></tr></table></figure>
<p>Switch#configure terminal<br>Switch(config)#clock timezone beijin 8<br>Switch(config)#ntp server 10.109.192.5<br>Switch(config)#ntp server 10.109.192.5    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 九、备份和还原IOS    </span><br><span class="line">特权配置模式下进入文件操作管理    </span><br><span class="line">filesystem     </span><br><span class="line">交换机用户模式下通过tftp备份iso固件到23.50.6.99服务器    </span><br><span class="line">格式：copy file-system 本地固件文件名 tftp 服务器IP 远程文件名    </span><br><span class="line">copy file-system web-Spl-1.1.235.rom tftp 23.50.6.99 123.rom    </span><br><span class="line">交换机用户模式下通过tftp服务器还原IOS到交换机中    </span><br><span class="line">格式：copy tftp 服务器IP 远程文件名file-system 本地固件文件名     </span><br><span class="line">copy tftp 23.50.6.99 234 file-system 234    </span><br><span class="line">使用dir命令，查看交换机固件的文件名称    </span><br><span class="line">配置示例：</span><br></pre></td></tr></table></figure>
<p>Switch#filesystem<br>Switch(config-fs)#dir<br>Switch(config-fs)#copy file-system sp4-g-6.6.4.1.18(C).pck tftp 23.50.6.99 123.pck<br>Switch(config-fs)#copy tftp 23.50.6.99 123.pck file-system sp4-g-6.6.4.1.18(C).pck    </p>
<pre><code>Tftp服务器可以下载软件3CDaemon在电脑上运行即可。    
# 十一、交换机常规巡检命令    
查看三层接口Ip地址    
show ip interface brief         
查看二层接口状态信息    
show interface switchport brief     
查看交换机的mac地址表    
show mac-address all     
查看交换机的arp表    
show arp        
查看交换机的生成树状态    
show spanning-tree     
查看交换机版本    
show version    
查看交换机系统时间    
show clock    
查看交换机电源状态    
show power    
查看交换机cpu使用状态    
show cpu monitor     
查看交换机内存使用状态    
show memory    </code></pre>
        </div>
		<div class="card-content" >
			<!-- 《添加版权声明 -->
			
			<!-- 添加版权声明》 -->
		</div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7"><i class="fa fa-tag"></i></span>
                    <a class="has-link-grey -link" href="/tags/%E4%BA%A4%E6%8D%A2%E6%9C%BA/" rel="tag">交换机</a>, <a class="has-link-grey -link" href="/tags/%E8%BF%88%E6%99%AE/" rel="tag">迈普</a>
                </div>
            </div>
        </div>
        
        
        
		</div>
    </div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2020/bd-basic/">
                <span class="level-item">博达交换机基础操作</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>


</div>
                
                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div  align="center" class="container">
		<div class="container">
		<img src="https://static.dy208.cn/o_1dfilp8ruo521thr1hvf18ji17soa.png">
		<a href="http://www.beian.miit.gov.cn/"  style="color:#f72b07" target="_blank">皖ICP:0000号</a>
	</div>
	
        <!-- 不蒜子统计 -->
        <span id="busuanzi_container_site_pv">
                本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv" style='display:none'>
                本站访客数<span id="busuanzi_value_site_uv"></span>人
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
        <div>
            <div   class="level-start has-text-centered-mobile">
                <p align="center" class="is-size-7">
                &copy; 2020 光明常在&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                </p>
            </div>
        </div>
    </div>
</footer>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'http://mmdav0.coding-pages.com',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'true'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>




<script src="/js/main.js" defer></script>

    
</body>
</html>