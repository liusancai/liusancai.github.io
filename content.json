{"pages":[{"title":"一个网络工程师的自述","text":"关于我一个资深网络工程师.长期从事网络运维工作，对网络管理有点心得，希望能够通过这个博客分享给大家。在工作中，积累了大量的实施工作经验。我系统地掌握了网络安全和系统安全方面的技术，涉及到服务器，防火墙，路由交换技术的配置和安全防护，能够独立处理非常规性网络异常，特别是针对因黑客攻击所引发的安全事故有一定的处理经验，熟练使用绿盟，天融信，深信服，启明星辰等主流网络安全厂商的安全设备，如：IPS，WAF，TAC，RSAS，上网行为管理器，防火墙设备。在网络自动化运维管理中，自己编写一款网络设备自动化运维工具软件，给自己在工作中节省很多时间，也希望给各位好友一起使用，因为需要对软件进行定制开发，更新，所以采取了授权方式，一个工程师版本的3年授权300元，欢迎大家联系，针对企业提供定制开发。(本网站作为唯一官方发布地址) 联系方式QQ: 313712640E-Mail: liusancai@aliyun.com个人博客: https://liusancai.github.io/工具下载(博客所有分享文件)：百度网盘: https://pan.baidu.com/s/1ogJjQkG7K3Og42kk-DHZEQ 提取码: cgv5","link":"/about/index.html"},{"title":"","text":"8iNYaSg7O9","link":"/baidu_verify_8iNYaSg7O9.html"}],"posts":[{"title":"各类交换机配置关闭分页(more)提示","text":"在配置自动化运维的时候，我们对交换机进行巡检，因为不是人工手动操作，所以为了效率，我们需要对交换机配置关闭more提示，同时为了防止干扰 我们需要关闭终端提示，来达到最好的巡检效果。下面介绍各类交换机配置的方式： 华为和H3C的交换机配置方式一样： 1234undo info-center enable #关闭信息提示user-interface vty 0 4 #进入虚拟终端接口 screen-length 0 #关闭more提示 quit #退出 思科和锐捷交换机配置: 12345conf t #进入配置模式 logging monitor 0 #关闭提示 line vty 0 4 #进入虚拟终端模式 length 0 #配置关闭分页 end #退出到系统模式 迈普和贝尔交换机配置： 1234more off #关闭分页configure terminal #进入配置模式 logging monitor 0 #关闭分页模式 end #退出到系统模式 博达交换机配置： 123456config #进入配置模式 line vty 0 4 #进入虚拟终端配置 length 0 #关闭分页 exit #退出 exit #退出注意:博达交换机没有找到配置关闭信息提示配置项 中兴交换机配置： 1terminal length 0 #直接在系统模式配置 针对各类交换机恢复配置，只需要针对上面的配置，进行undo 或者 no 即可，不在演示。","link":"/2020/02/01/switch-0201/"},{"title":"网络设备自动备份","text":"一、软件介绍随着企业信息化的发展，更多的业务依赖于网络，核心业务对网络的要求更加的高，作为企业的网络管理人员，面对的大量的网络设备，造成了日常维护工作量大，没有有效的方式进行统一管理配置，不能快速的定位网络故障点，更新配置时需要手动登录交换机一台台的操作，给日常运维带来了很大的挑战。虽然市场上有着成熟的网管软件，但是存在价格昂贵，部署复杂，自定义内容的配置少，不够自定义巡检内容，不能够批量下发配置等功能限制，导致很多企业的网管还是处在初期的人工手动维护状态，本软件具有程序小，无需部署，无需安装，使用方便等特点，主要功能如下： 批量巡检 自定义巡检 批量关闭空闲端口 批量开启全部端口 配置端口安全功能 批量保存配置目前软件支持市场长大部分厂家设备，华为，华三，思科，锐捷，中兴，博达，迈普，贝尔等8个厂商的设备。软件支持二次定制开发，根据网络中的设备进行匹配。 二、软件功能 批量巡检功能自动登录网络设备，执行命令，形成日志文件后，分析文件生成巡检报告，报告内容包含单台网络设备的启动设备，设备版本，风扇，电源，cpu，内存使用率等，对在网的所有设备的mac地址表和arp表进行整合表格，方便了解网络设备和终端设备的信息。只有日常巡检能够生成报表，其他功能无报表。 自定义巡检功能能够根据自定义的命令对交换机下发配置命令，打开conf文件夹下的各厂商配置文件，在def=字段后面输入本次需要执行的命令即可。 批量关端空闲端口，通过运行交换机查看mac地址的命令，进行分析端口下的mac地址情况，对于没有使用的端口进行自动关闭操作。 批量开启全部端口，通过分析设备的运行配置分析出设备的所有端口，根据分析出的端口列表，自动进入端口模式，执行开启端口操作。 配置端口安全功能是根据分析端口下的配置信息，mac地址信息，自动根据预设好的端口安全配置方式，进行全网设备的统一配置。 批量保存配置功能是根据设备列表登录到设备中，执行保存配置的命令，为了防止配置丢失导致的网络故障。三、使用准备使用软件之前，需要准备一个设备列表的excel文件，按照示例内容填写。主要如下：序号 IP 用户名 密码 特权密码 厂商 端口 设备功能 站点名称 备注1 192.168.1.1 user password rootword h3c 22 switch 测试12 192.168.1.2 user password h3c 22 router 测试2提示：该文件保存了设备的用户密码信息，请管理员妥善保管此文件，防止文件泄露，造成网络信息安全问题。定制功能使用前先测试，各位工程师的配置不太一样。下载地址：百度网盘链接: https://pan.baidu.com/s/1DXoZdMQ3SXuCHEy_HB5J_w本软件采用离线授权的方式，具体费用请联系作者","link":"/2020/01/30/switch-back/"},{"title":"H3C交换机基础操作","text":"一、配置本地用户认证全局配置模式下 创建用户，配置用户名为test用户 local-user test class manage 配置用户密码为Password123 password simple Password123 配置用户登录方式为SSH service-type ssh 配置用户权限等级为0 authorization-attribute user-role level-0 配置特权密码为testpassword super password simple testpassword 配置示例： 12345678[H3C]local-user test class manageNew local user added.[H3C-luser-manage-test]password simple Password123[H3C-luser-manage-test]service-type ssh[H3C-luser-manage-test]authorization-attribute user-role level-0[H3C-luser-manage-test]exit[H3C]super password simple testpassword[H3C] 二、配置VLAN全局配置模式下，创建vlan 10 Vlan 10 添加描述信息 description Bangong 配置示例： 12345[H3C]vlan 10[H3C-vlan10]des[H3C-vlan10]description Bangong[H3C-vlan10]exit[H3C] 三、端口加入VLAN配置access类型端口 全局模式下进入端口配置模式 进入G1/0/1 interface GigabitEthernet 1/0/1 配置端口模式为access模式 port link-type access 配置端口所属vlan port access vlan 10 配置示例： 123456[H3C]interface GigabitEthernet 1/0/1[H3C-GigabitEthernet1/0/1]interface GigabitEthernet 1/0/1[H3C-GigabitEthernet1/0/1]port link-type access[H3C-GigabitEthernet1/0/1]port access vlan 10[H3C-GigabitEthernet1/0/1]exit[H3C] 配置trunk类型端口（trunk类型端口适用于交换机接交换机） 全局模式下进入端口配置模式 进入G1/0/24 interface GigabitEthernet 1/0/24 配置端口模式为trunk模式 port link-type trunk 配置端口允许通过的VLAN port trunk permit vlan 10 20 配置示例： 12345[H3C]interface GigabitEthernet 1/0/24[H3C-GigabitEthernet1/0/24]port link-type trunk[H3C-GigabitEthernet1/0/24]port trunk permit vlan 10 20[H3C-GigabitEthernet1/0/24]exit[H3C] 四、配置接口 VLAN IP全局模式下进入vlanif接口配置模式 进入vlan10 三层接口 interface Vlan-interface 10 配置IP地址 192.168.1.1 掩码255.255.255.0 ip address 192.168.1.1 255.255.255.0 配置示例： 1234[H3C]interface Vlan-interface 10[H3C-Vlan-interface10]ip address 192.168.1.1 255.255.255.0[H3C-Vlan-interface10]exit[H3C] 五、配置静态默认路由全局配置模式下，配置默认路由的下一跳为192.168.1.2 ip route-static 0.0.0.0 0.0.0.0 192.168.1.2 静态路由配置和默认路由配置命令一样，命令中前0.0.0.0 代表网络号，后面一个0.0.0.0代表掩码。这8个0则能代表所有网段。代码一个24未掩码的网段表示：192.168.2.0 255.255.255.0 配置静态路由： ip route-static 192.168.2.0 255.255.255.0 192.168.1.2 六、配置生成树选项生成树配置需要结合当地网络进行配置，要所有运行在一个拓扑能开启生成树功能的交换机，生成树配置一样。 全局模式下开启生成树功能 Stp enable 全局模式下关闭生成树功能 Stp disable 进入MST域视图 stp region-configuration 配置MST域名 region-name aqhn 配置实例1包含vlan10 instance 1 vlan 18 配置实例2包含vlan20 instance 2 vlan 20 激活MST域配置 active region-configuration 不包含实例中的vlan，全部属于默认实例0，如vlan1默认属于实例0 配置示例： 1234567[H3C]stp region-configuration[H3C-mst-region]region-name aqhn[H3C-mst-region]instance 1 vlan 10[H3C-mst-region]instance 2 vlan 20[H3C-mst-region]active region-configuration[H3C-mst-region]exit[H3C] 七、配置ACL访问控制策略进入acl配置模式 acl number 2000 或者 acl basic 2000 #number数字可配置2000-2999,基础ACL配置. 配置一条允许24.50.0.67主机 rule 0 permit source 24.50.0.67 0 配置一条允许23.50.6.0网段 rule 5 permit source 23.50.6.0 0.0.0.255 剩余的全部禁止 rule 10 deny 配置acl注意匹配规则是从上往下匹配，比如rule10 deny已经拒绝了除0,5匹配到的，剩余的都是禁止。这时候rule 15 permit source 23.50.7.0 0.0.0.255，则该策略不生效，23.50.7.0网段还是被全部禁止。 配置示例： 123456[H3C]acl basic 2000[H3C-acl-ipv4-basic-2000]rule 0 permit source 24.50.0.67 0[H3C-acl-ipv4-basic-2000]rule 5 permit source 23.50.6.0 0.0.0.255[H3C-acl-ipv4-basic-2000]rule 10 deny[H3C-acl-ipv4-basic-2000]exit[H3C] 八、配置SSH远程登陆全局开启ssh服务 ssh server enable 配置用户test使用ssh服务时采用密码登陆 ssh user test service-type stelnet authentication-type password 本地创建RSA加密类型密钥对 public-key local create rsa 本地创建DSA加密类型密钥对 public-key local create dsa 建议比较老的交换机同时生成这2个类型的加密密钥。否则可能导致不能使用ssh2方式登陆。 进入配置交换机的vty接口模式下，下面相当于可以同时5个人登陆这台交换机 user-interface vty 0 4 配置远程登陆的认证模式为AAA，即为本地用户认证 authentication-mode scheme 设置超时5分钟自动断开回话 idle-timeout 5 0 配置只允许ssh方式登陆交换机 protocol inbound ssh 配置示例： 12345678910[H3C]ssh server enable[H3C]ssh user test service-type stelnet authentication-type password[H3C]user-interface vty 0 4[H3C-line-vty0-4]authentication-mode scheme[H3C-line-vty0-4]idle-timeout 5 0[H3C-line-vty0-4]protocol inbound ssh[H3C-line-vty0-4]exit[H3C]public-key local create rsa[H3C]public-key local create dsa[H3C] 九、配置时钟同步和时区全局模式下配置时区为北京时区(加8小时) [H3C]clock timezone BeiJin add 8 全局模式下配置时钟服务器10.109.192.5为第一个时钟服务器 [H3C]ntp-service unicast-server 10.109.192.5 priority 全局模式下配置时钟服务器10.109.192.43为备用时钟服务器 [H3C] ntp-service unicast-server 10.109.192.43 十、备份和还原IOS交换机用户模式下通过tftp备份iso固件到23.50.6.99服务器 格式：tftp 服务器IP put 本地文件名 [远程文件名] tftp 23.50.6.99 put s31ei_e-cmw310-r2108p04.bin [可选配置重命名文件] 交换机用户模式下通过tftp服务器还原IOS到交换机中 格式：tftp 服务器IP get 远程文件名 [本地文件名] tftp 23.50.6.99 get s31ei_e-cmw310-r2108p04.bin [可选下载到交换机后文件重命名] 配置示例： 通过display boot-loader命令查看当前交换机使用的IOS文件名 12345678&lt;H3C&gt;display boot-loader Unit 1: The current boot app is: s31ei_e-cmw310-r2108p04.bin The main boot app is: s31ei_e-cmw310-r2108p04.bin The backup boot app is: &lt;H3C&gt;&lt;H3C&gt;tftp 23.50.6.99 put s31ei_e-cmw310-r2108p04.bin &lt;H3C&gt;tftp 23.50.6.99 get s31ei_e-cmw310-r2108p04.bin Tftp服务器可以下载软件3CDaemon在电脑上运行即可。 十一、交换机常规巡检命令查看三层接口Ip地址 display ip interface brief 查看二层接口状态信息 display interface brief 查看交换机的mac地址表 display mac-address 查看交换机的arp表 display arp 查看交换机的生成树状态 display stp brief 查看交换机版本 display version 查看交换机系统时间 display clock 查看交换机电源状态 display power 查看交换机风扇状态 display fan 查看交换机cpu使用状态 display cpu-usage history 查看交换机内存使用状态 display memory","link":"/2020/02/01/swithc-h3c-01/"}],"tags":[{"name":"自动化运维","slug":"自动化运维","link":"/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4/"},{"name":"交换机","slug":"交换机","link":"/tags/%E4%BA%A4%E6%8D%A2%E6%9C%BA/"},{"name":"华为","slug":"华为","link":"/tags/%E5%8D%8E%E4%B8%BA/"},{"name":"备份","slug":"备份","link":"/tags/%E5%A4%87%E4%BB%BD/"},{"name":"H3C","slug":"H3C","link":"/tags/H3C/"},{"name":"华三","slug":"华三","link":"/tags/%E5%8D%8E%E4%B8%89/"}],"categories":[{"name":"网络技术","slug":"网络技术","link":"/categories/%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/"}]}